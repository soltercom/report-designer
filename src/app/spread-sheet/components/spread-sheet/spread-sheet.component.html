<div class="table-wrapper">
  <table (mouseenter)="onTableEnter()" (mouseleave)="onTableLeave()">
    <mat-divider cdkDrag [vertical]="true" cdkDragLockAxis="x"
                 class="col-divider"
                 *ngFor="let col of ssService.columns"
                 [cdkDragFreeDragPosition]="ssService.getColumnDragPosition(col.num)"
                 (cdkDragEnded)="onColumnDragEnded($event, col.num)"></mat-divider>
    <mat-divider cdkDrag cdkDragLockAxis="y"
                 class="row-divider"
                 *ngFor="let row of ssService.rows"
                 [cdkDragFreeDragPosition]="ssService.getRowDragPosition(row.num)"
                 (cdkDragEnded)="onRowDragEnded($event, row.num)"></mat-divider>
    <tbody>
      <tr>
        <td class="null-cell"></td>
        <td class="col-header-cell" *ngFor="let col of ssService.columns"
            [style.min-width]="col.widthPx">
          {{col.num}}
        </td>
      </tr>
      <tr *ngFor="let row of ssService.rows; let i=index;">
        <td class="row-header-cell"
            [style.height]="row.heightPx">{{row.num}}</td>
        <td class="normal-cell"
            *ngFor="let col of ssService.columns; let j=index;"
            [class.mat-elevation-z4]="isSelected(i, j)"
            (click)="selectCell(i, j)">
          <div [style.max-height]="row.heightPx">{{getFormattedText(i, j)}}</div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
